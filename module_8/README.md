# skillfactory_rds
Проект №8. Возьмете Бэтмобиль?
========================

* Название комманды на Kaggle: Polina&Aleksandr
* Cостав комманды: [Polina Rudakova](https://github.com/Polinia), [Aleksandr](https://github.com/AleksandrBychkov?tab=overview&from=2021-04-01&to=2021-04-14)


Public Score on Kaggle.com: 10.77901
------------
Задача
-----------
https://www.kaggle.com/c/sf-dst-car-price-prediction-part2

Предсказать стоимость автомобиля по его характеристикам, текстовому описанию или картинке

Описание признаков
------------------------
* bodyType - категориальный
* brand - категориальный
* color - категориальный
* description - текстовый
* engineDisplacement - числовой, представленный как текст
* enginePower - числовой, представленный как текст
* fuelType - категориальный
* mileage - числовой
* modelDate - числовой
* model_info - категориальный
* name - категориальный, желательно сократить размерность - не используется (комбинация других столбцов)
* numberOfDoors - категориальный
* price - числовой, целевой
* productionDate - числовой
* sell_id - изображение (файл доступен по адресу, основанному на sell_id)
* vehicleTransmission - категориальный
* vehicleConfiguration — не используется (комбинация других столбцов)
* Владельцы - категориальный
* Владение - числовой, представленный как текст
* ПТС - категориальный
* Привод - категориальный
* Руль - категориальный

В результате работы было достигнуто следующее:
--------------
Построили "наивную"/baseline модель, предсказывающую цену по модели и году выпуска (с ней сравнивали другие модели)

Обработали и отнормироавали признаки

Сделали первую модель на основе градиентного бустинга с помощью CatBoost

Сделали вторую модель на основе нейронных сетей и сравнили результаты

Сделали multi-input нейронную сеть для анализа табличных данных и текста одновременно

Добавили в multi-input сеть обработку изображений

Осуществили ансамблирование градиентного бустинга и нейронной сети (усреднение их предсказаний)

Выводы:
-------
Проведена вся необходимая работа по подготовке данных, их анализ, обработка и подготовка для дальнейшей работы. Датасет очищен от дубликатов и выбросов, выполнена нормализация, 
использовались классические методы кодирования категориальных признаков. Были созданы дополнительные признаки. По итогам анализа, часть признаков,
в том числе на основе анализа корреляции, удалена. Использовались классические методы обработки языка. В модели применялась токенизация и лемматизация.
При работе с изображениями использовался собственный код аугментации на основе библиотеки albumentation. Были проведены эксперименты с другими типовыми моделями EfficientNet, 
часть из которых приводила к переобучению. Применялась регулировка Learning Rate. Так же использовались Fine-tuning и Transfer Learning.
По итогам блендирования удалось достичь хороших результатов метрики 10.77901.

Структура репозитория
-----------------
В папке [data](https://github.com/Polinia/skillfactory_rds/tree/main/module_8/data) находятся файлы для скачивания:

* sample_submission.scv
* test.scv
* test.scv
* img
